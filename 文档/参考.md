## java代理模式
[参考文档：Java代理（Proxy）模式](https://www.jianshu.com/p/8ccdbe00ff06)

##原理
无论是Cglib代理还是JDK代理，都需要  
1. 一个实例，一般命名为target
2. 一个接口（实现增强的类），组合了target实例。最终使用反射来调用实例方法。
3. 一个专门的工具类来创建代理

| 代理方式    | 被代理的类的实例    | 实现一个接口(组合了target类) | 创建代理的类                      |
|---------|-------------|--------------------|-----------------------------|
| Cglib   | 具体类(不用实现接口) | MethodInterceptor  | (Enhancer)enhancer.create() |
| JDK动态代理 | 实现接口的类      | InvocationHandler  | Proxy.newProxyInstance(...) |


## JDK动态代理生成的类反编译如下：
```java

public final class $Proxy0 extends Proxy implements AdminService {
    
    //定义了接口中的所有方法对象变量
    private static Method m1;
    private static Method m4;
    private static Method m2;
    private static Method m5;
    private static Method m0;
    private static Method m3;

    static {
        try {
            m1 = Class.forName("java.lang.Object").getMethod("equals", Class.forName("java.lang.Object"));
            m4 = Class.forName("基础知识.代理模式.AdminService").getMethod("find");
            m2 = Class.forName("java.lang.Object").getMethod("toString");
            m5 = Class.forName("基础知识.代理模式.AdminService").getMethod("find", Class.forName("java.lang.String"));
            m0 = Class.forName("java.lang.Object").getMethod("hashCode");
            m3 = Class.forName("基础知识.代理模式.AdminService").getMethod("update");
        } catch (NoSuchMethodException var2) {
            throw new NoSuchMethodError(var2.getMessage());
        } catch (ClassNotFoundException var3) {
            throw new NoClassDefFoundError(var3.getMessage());
        }
    }
    //有一个带参数的构造参数，传入InvocationHandler接口的实例
    public $Proxy0(InvocationHandler var1) throws  Exception{
        super(var1);
    }

    public final Object find(String var1) throws  Exception{
        try {
            //执行方法的时候，调用InvocationHandler的唯一方法， 传入对应的方法对象。具体增强在invoke方法内实现。
            return (Object)super.h.invoke(this, m5, new Object[]{var1});
        } catch (RuntimeException | Error var3) {
            throw var3;
        } catch (Throwable var4) {
            throw new UndeclaredThrowableException(var4);
        }
    }
    //省略部分方法。
}
```